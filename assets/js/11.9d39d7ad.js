(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{511:function(a,t,s){a.exports=s.p+"assets/img/lookup and translation.e7ea50bd.png"},512:function(a,t,s){a.exports=s.p+"assets/img/execution time.173c4737.png"},513:function(a,t,s){a.exports=s.p+"assets/img/performance comparision.84b6e5d7.png"},514:function(a,t,s){a.exports=s.p+"assets/img/miss rate.1850550a.png"},557:function(a,t,s){"use strict";s.r(t);var i=s(6),m=Object(i.a)({},(function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[i("p",[a._v("本文主要设计了加速核，通过加速核，对二进制翻译进行加速。\n加速核独立于CPU，通过其Tcache以及翻译模块，加速整体效率。")]),a._v(" "),i("h2",{attrs:{id:"简介"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[a._v("#")]),a._v(" 简介")]),a._v(" "),i("h3",{attrs:{id:"研究的问题"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#研究的问题"}},[a._v("#")]),a._v(" 研究的问题")]),a._v(" "),i("p",[a._v("通过加速核，对二进制翻译进行加速。\n加速核独立于CPU，通过其Tcache以及翻译模块，加速整体效率。")]),a._v(" "),i("ul",[i("li",[a._v("提高查找下一个基本块的速度")]),a._v(" "),i("li",[a._v("不需要上下文切换，提高cache利用，减少启动时间")])]),a._v(" "),i("h3",{attrs:{id:"结论"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#结论"}},[a._v("#")]),a._v(" 结论")]),a._v(" "),i("p",[a._v("虚拟机性能几乎达到了本机性能的40%")]),a._v(" "),i("h2",{attrs:{id:"开销分析"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#开销分析"}},[a._v("#")]),a._v(" 开销分析")]),a._v(" "),i("p",{staticClass:"katex-block"},[i("span",{staticClass:"katex-display"},[i("span",{staticClass:"katex"},[i("span",{staticClass:"katex-mathml"},[i("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[i("semantics",[i("mrow",[i("mi",[a._v("T")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("t")]),i("mi",[a._v("o")]),i("mi",[a._v("t")]),i("mi",[a._v("a")]),i("mi",[a._v("l")]),i("mo",[a._v("=")]),i("mo",{attrs:{stretchy:"false"}},[a._v("(")]),i("mn",[a._v("1")]),i("mo",[a._v("−")]),i("mi",[a._v("F")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("l")]),i("mi",[a._v("i")]),i("mi",[a._v("n")]),i("mi",[a._v("k")]),i("mi",[a._v("e")]),i("mi",[a._v("d")]),i("mo",{attrs:{stretchy:"false"}},[a._v(")")]),i("mo",[a._v("∗")]),i("mo",{attrs:{stretchy:"false"}},[a._v("(")]),i("mi",[a._v("T")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("l")]),i("mi",[a._v("o")]),i("mi",[a._v("o")]),i("mi",[a._v("k")]),i("mi",[a._v("u")]),i("mi",[a._v("p")]),i("mo",[a._v("+")]),i("mi",[a._v("T")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("c")]),i("mi",[a._v("o")]),i("mi",[a._v("n")]),i("mi",[a._v("t")]),i("mi",[a._v("e")]),i("mi",[a._v("x")]),i("mi",[a._v("t")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("s")]),i("mi",[a._v("w")]),i("mi",[a._v("i")]),i("mi",[a._v("t")]),i("mi",[a._v("c")]),i("mi",[a._v("h")]),i("mo",{attrs:{stretchy:"false"}},[a._v(")")]),i("mo",[a._v("+")]),i("mi",[a._v("T")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("e")]),i("mi",[a._v("x")]),i("mi",[a._v("e")]),i("mi",[a._v("c")]),i("mi",[a._v("u")]),i("mi",[a._v("t")]),i("mi",[a._v("i")]),i("mi",[a._v("o")]),i("mi",[a._v("n")]),i("mo",[a._v("+")]),i("mi",[a._v("F")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("c")]),i("mi",[a._v("a")]),i("mi",[a._v("c")]),i("mi",[a._v("h")]),i("mi",[a._v("e")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("m")]),i("mi",[a._v("i")]),i("mi",[a._v("s")]),i("mi",[a._v("s")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("r")]),i("mi",[a._v("a")]),i("mi",[a._v("t")]),i("mi",[a._v("e")]),i("mo",[a._v("∗")]),i("mi",[a._v("T")]),i("mi",{attrs:{mathvariant:"normal"}},[a._v("_")]),i("mi",[a._v("t")]),i("mi",[a._v("r")]),i("mi",[a._v("a")]),i("mi",[a._v("n")]),i("mi",[a._v("s")]),i("mi",[a._v("l")]),i("mi",[a._v("a")]),i("mi",[a._v("t")]),i("mi",[a._v("i")]),i("mi",[a._v("o")]),i("mi",[a._v("n")])],1),i("annotation",{attrs:{encoding:"application/x-tex"}},[a._v("T\\_total = (1-F\\_linked) * (T\\_lookup + T\\_context\\_switch) + T\\_execution + F\\_cache\\_miss\\_rate * T\\_translation \n")])],1)],1)],1),i("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.00444em","vertical-align":"-0.31em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[a._v("T")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal"},[a._v("o")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal"},[a._v("a")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[a._v("l")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),i("span",{staticClass:"mrel"},[a._v("=")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),i("span",{staticClass:"mopen"},[a._v("(")]),i("span",{staticClass:"mord"},[a._v("1")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[a._v("−")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.06em","vertical-align":"-0.31em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[a._v("F")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[a._v("l")]),i("span",{staticClass:"mord mathnormal"},[a._v("i")]),i("span",{staticClass:"mord mathnormal"},[a._v("n")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03148em"}},[a._v("k")]),i("span",{staticClass:"mord mathnormal"},[a._v("e")]),i("span",{staticClass:"mord mathnormal"},[a._v("d")]),i("span",{staticClass:"mclose"},[a._v(")")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[a._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.06em","vertical-align":"-0.31em"}}),i("span",{staticClass:"mopen"},[a._v("(")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[a._v("T")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[a._v("l")]),i("span",{staticClass:"mord mathnormal"},[a._v("o")]),i("span",{staticClass:"mord mathnormal"},[a._v("o")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03148em"}},[a._v("k")]),i("span",{staticClass:"mord mathnormal"},[a._v("u")]),i("span",{staticClass:"mord mathnormal"},[a._v("p")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[a._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.06em","vertical-align":"-0.31em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[a._v("T")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal"},[a._v("c")]),i("span",{staticClass:"mord mathnormal"},[a._v("o")]),i("span",{staticClass:"mord mathnormal"},[a._v("n")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal"},[a._v("e")]),i("span",{staticClass:"mord mathnormal"},[a._v("x")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal"},[a._v("s")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02691em"}},[a._v("w")]),i("span",{staticClass:"mord mathnormal"},[a._v("i")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal"},[a._v("c")]),i("span",{staticClass:"mord mathnormal"},[a._v("h")]),i("span",{staticClass:"mclose"},[a._v(")")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[a._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"0.99333em","vertical-align":"-0.31em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[a._v("T")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal"},[a._v("e")]),i("span",{staticClass:"mord mathnormal"},[a._v("x")]),i("span",{staticClass:"mord mathnormal"},[a._v("e")]),i("span",{staticClass:"mord mathnormal"},[a._v("c")]),i("span",{staticClass:"mord mathnormal"},[a._v("u")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal"},[a._v("i")]),i("span",{staticClass:"mord mathnormal"},[a._v("o")]),i("span",{staticClass:"mord mathnormal"},[a._v("n")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[a._v("+")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.00444em","vertical-align":"-0.31em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[a._v("F")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal"},[a._v("c")]),i("span",{staticClass:"mord mathnormal"},[a._v("a")]),i("span",{staticClass:"mord mathnormal"},[a._v("c")]),i("span",{staticClass:"mord mathnormal"},[a._v("h")]),i("span",{staticClass:"mord mathnormal"},[a._v("e")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal"},[a._v("m")]),i("span",{staticClass:"mord mathnormal"},[a._v("i")]),i("span",{staticClass:"mord mathnormal"},[a._v("s")]),i("span",{staticClass:"mord mathnormal"},[a._v("s")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[a._v("r")]),i("span",{staticClass:"mord mathnormal"},[a._v("a")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal"},[a._v("e")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),i("span",{staticClass:"mbin"},[a._v("∗")]),i("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),i("span",{staticClass:"base"},[i("span",{staticClass:"strut",staticStyle:{height:"1.00444em","vertical-align":"-0.31em"}}),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[a._v("T")]),i("span",{staticClass:"mord",staticStyle:{"margin-right":"0.02778em"}},[a._v("_")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[a._v("r")]),i("span",{staticClass:"mord mathnormal"},[a._v("a")]),i("span",{staticClass:"mord mathnormal"},[a._v("n")]),i("span",{staticClass:"mord mathnormal"},[a._v("s")]),i("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[a._v("l")]),i("span",{staticClass:"mord mathnormal"},[a._v("a")]),i("span",{staticClass:"mord mathnormal"},[a._v("t")]),i("span",{staticClass:"mord mathnormal"},[a._v("i")]),i("span",{staticClass:"mord mathnormal"},[a._v("o")]),i("span",{staticClass:"mord mathnormal"},[a._v("n")])])])])])]),a._v(" "),i("ol",[i("li",[a._v("没有链接情况下，下个TB寻找")]),a._v(" "),i("li",[a._v("上下文切换开销")]),a._v(" "),i("li",[a._v("翻译开销")])]),a._v(" "),i("h2",{attrs:{id:"解决办法"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[a._v("#")]),a._v(" 解决办法")]),a._v(" "),i("h3",{attrs:{id:"硬件来实现tcache-target-code-cache-管理器"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#硬件来实现tcache-target-code-cache-管理器"}},[a._v("#")]),a._v(" 硬件来实现Tcache(Target code cache)管理器")]),a._v(" "),i("p",[a._v("Tcache管理器维护一个SPC-TPC(source PC, target PC)映射表，类似于TLB实现虚拟地址到物理地址的映射。")]),a._v(" "),i("ul",[i("li",[a._v("通过分支预测翻译单元可以提高块的链接率")]),a._v(" "),i("li",[a._v("采样出热点块让软件优化")]),a._v(" "),i("li",[a._v("（实际上）还加快了查找下一个基本块的速度")])]),a._v(" "),i("h3",{attrs:{id:"硬件翻译模块"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#硬件翻译模块"}},[a._v("#")]),a._v(" 硬件翻译模块")]),a._v(" "),i("p",[a._v("优势：")]),a._v(" "),i("ul",[i("li",[a._v("由于硬件翻译，不需要上下文切换（翻译进程和执行的切换）")]),a._v(" "),i("li",[a._v("实际上的cache命中提高（不用上下文切换，cache刷新少），减少启动时间")]),a._v(" "),i("li",[a._v("如果硬件转换单元在处理器执行相应指令之前转换基本块，则可以显著降低Tcache的失效率 <?")])]),a._v(" "),i("p",[a._v("实现：")]),a._v(" "),i("ol",[i("li",[a._v("维护"),i("code",[a._v("SPC")]),a._v("、"),i("code",[a._v("TPC")]),a._v("以及"),i("code",[a._v("hit_miss_reg")]),a._v("用于"),i("code",[a._v("native code")]),a._v("运行切换")]),a._v(" "),i("li",[a._v("在没有被链接时，写"),i("code",[a._v("SPC")]),a._v("以及"),i("code",[a._v("hit_miss_reg")]),a._v("，让DBT启动翻译")]),a._v(" "),i("li",[i("code",[a._v("loop hit_miss_reg")]),a._v("，直到翻译完成")]),a._v(" "),i("li",[a._v("DBT会修改"),i("code",[a._v("hit_miss_reg")]),a._v("以及"),i("code",[a._v("TPC")])]),a._v(" "),i("li",[i("code",[a._v("jmp TPC")]),a._v("，执行下一个block")])]),a._v(" "),i("h2",{attrs:{id:"结果"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#结果"}},[a._v("#")]),a._v(" 结果")]),a._v(" "),i("ul",[i("li",[a._v("对于"),i("code",[a._v("lookup and translation")]),a._v("，\n大约20个周期就可以完成查找操作，而转换一个基本块只需要不到60个周期。有10-25倍的加速。")]),a._v(" "),i("li",[a._v("对于"),i("code",[a._v("execution time in hit and miss case")]),a._v("，\n性能在命中和非命中之间没有明显的波动，这一特性对软件的实时性和启动性能至关重要。")]),a._v(" "),i("li",[a._v("协同设计的虚拟机性能几乎达到了本机性能的40%")]),a._v(" "),i("li",[a._v("Tcache大小足够大，SPEC 2000程序的失效率就会非常低。")])]),a._v(" "),i("p",[a._v("另外，由于协处理器的转换单元大部分时间是空闲的")]),a._v(" "),i("ul",[i("li",[a._v("为多处理器提供服务的能力，因为虚拟机协处理器的低缺失率")]),a._v(" "),i("li",[a._v("不需要的时候可以关闭翻译单元，以减少功耗")])]),a._v(" "),i("table",[i("thead",[i("tr",[i("th",{staticStyle:{"text-align":"center"}},[i("code",[a._v("lookup and translation")])]),a._v(" "),i("th",{staticStyle:{"text-align":"center"}},[i("code",[a._v("execution time in hit and miss case")])])])]),a._v(" "),i("tbody",[i("tr",[i("td",{staticStyle:{"text-align":"center"}},[i("img",{attrs:{src:s(511)}})]),a._v(" "),i("td",{staticStyle:{"text-align":"center"}},[i("img",{attrs:{src:s(512)}})])])])]),a._v(" "),i("table",[i("thead",[i("tr",[i("th",{staticStyle:{"text-align":"center"}},[a._v("整体性能")]),a._v(" "),i("th",{staticStyle:{"text-align":"center"}},[a._v("Tcache大小和失效率")])])]),a._v(" "),i("tbody",[i("tr",[i("td",{staticStyle:{"text-align":"center"}},[i("img",{attrs:{src:s(513)}})]),a._v(" "),i("td",{staticStyle:{"text-align":"center"}},[i("img",{attrs:{src:s(514)}})])])])])])}),[],!1,null,null,null);t.default=m.exports}}]);